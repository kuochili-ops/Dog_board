<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Doggy App Fixed</title>
    <style>
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            background-color: #333; overflow: hidden; font-family: sans-serif;
        }

        /* 3D 容器 */
        .stage {
            position: relative; width: 100vw; height: 100vh;
            display: flex; justify-content: center; align-items: center;
            perspective: 1000px;
        }

        /* 狗狗圖片層 */
        .dog-sprite {
            width: 100%; height: auto; max-width: 500px;
            /* 請確保 IMG_5730.png 與此檔在同目錄 */
            background: url('IMG_5730.png') no-repeat center center;
            background-size: contain;
            aspect-ratio: 3/4; /* 根據你錄影中的狗狗比例調整 */
            transform-origin: center 85%;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* 嘴巴掛點：我們改用百分比定位在狗狗臉部中央 */
        .mouth-anchor {
            position: absolute;
            top: 42%; left: 50%;
            transform: translateX(-50%);
            display: flex; flex-direction: column; align-items: center;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* 黑板組件：初始躺在腳前 (Y 軸設為 100px) */
        .pendant {
            transform-origin: top center;
            transform: translateY(100px) rotateX(-85deg); 
            opacity: 1; /* 先設為 1 確保能看到畫面 */
            transition: transform 1.2s cubic-bezier(0.1, 0.5, 0.1, 1), opacity 0.5s;
        }

        /* 繩帶：緊貼狗嘴 */
        .rope {
            width: 40px; height: 15px;
            border-left: 3px solid #bda27e; border-right: 3px solid #bda27e;
        }

        .blackboard {
            width: 180px; min-height: 100px;
            background: #2c3e50; border: 5px solid #4e342e; border-radius: 8px;
            display: flex; justify-content: center; align-items: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .chalk-text { color: white; font-size: 20px; font-weight: bold; padding: 10px; text-align: center; }

        /* 動畫觸發狀態 */
        .is-bowing .dog-sprite { transform: rotateX(25deg) translateY(30px) scale(1.1); }
        .is-bowing .mouth-anchor { transform: translateX(-50%) translateY(30px) scale(1.1); }
        .is-active .pendant { transform: translateY(0) rotateX(0deg); }

        /* UI Panel */
        .ui { position: fixed; bottom: 20px; width: 90%; left: 5%; display: flex; z-index: 100; }
        input { flex: 1; padding: 12px; border-radius: 25px 0 0 25px; border: none; font-size: 16px; }
        button { padding: 12px 20px; border-radius: 0 25px 25px 0; border: none; background: #ff4757; color: white; font-weight: bold; }
    </style>
</head>
<body>

    <div class="stage" id="app">
        <div class="dog-sprite"></div>
        <div class="mouth-anchor">
            <div class="pendant">
                <div class="rope"></div>
                <div class="blackboard">
                    <div id="display" class="chalk-text">汪！</div>
                </div>
            </div>
        </div>
    </div>

    <div class="ui">
        <input type="text" id="userInput" placeholder="輸入文字...">
        <button onclick="DogApp.start()">送出</button>
    </div>

    <script>
        const DogApp = (function() {
            const app = document.getElementById('app');
            const display = document.getElementById('display');
            const input = document.getElementById('userInput');

            return {
                start: function() {
                    const text = input.value.trim();
                    if (!text) return;

                    display.innerText = text;
                    app.classList.remove('is-bowing', 'is-active');

                    // 1. 低頭
                    setTimeout(() => {
                        app.classList.add('is-bowing');

                        // 2. 銜起黑板 (停頓 0.5s)
                        setTimeout(() => {
                            app.classList.add('is-active');

                            // 3. 抬頭恢復
                            setTimeout(() => {
                                app.classList.remove('is-bowing');
                            }, 1000);
                        }, 500);
                    }, 50);

                    input.value = '';
                }
            };
        })();
    </script>
</body>
</html>
